syntax = "proto3";

package audit;

option go_package = "";

service AuditService {
    rpc WriteLog(WriteLogRequest) returns (WriteLogResponce);
    rpc GetLogs (GetLogsRequest) returns (GetLogsResponce);
}

message WriteLogRequest {
    string service_name = 1;   // кто вызвал (sso, user и т.д.)
    string action = 2;         // create_user, login, delete_tour ...
    string user_id = 3;        // кто сделал
    string details = 4;        // произвольное описание
    string timestamp = 5;      // время
}

message WriteLogResponce {
    bool success = 1;
}

message GetLogsRequest {
    string service_name = 1;
    string user_id = 2;
}

message GetLogsResponce {
    repeated AuditEntry logs = 1;
}

message AuditEntry {
    string id = 1;
    string service_name = 2;
    string action = 3;
    string user_id = 4;
    string details = 5;
    string timestamp = 6;
}